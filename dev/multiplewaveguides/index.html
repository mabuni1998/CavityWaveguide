<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Multiple waveguides · WaveguideQED.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/style.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">WaveguideQED.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">WaveguideQED.jl</a></li><li><a class="tocitem" href="../theoreticalbackground/">Theoretical Background</a></li><li><a class="tocitem" href="../tutorial/">Tutorials</a></li><li><a class="tocitem" href="../detection/">Detection and Projections</a></li><li class="is-active"><a class="tocitem" href>Multiple waveguides</a><ul class="internal"><li><a class="tocitem" href="#twowaveguide"><span>Two Waveguides</span></a></li><li><a class="tocitem" href="#Beamsplitter"><span>Beamsplitter</span></a></li><li><a class="tocitem" href="#Swap"><span>Swap</span></a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../example_lodahl/">Scattering on two level system</a></li></ul></li><li><a class="tocitem" href="../API/">API</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Multiple waveguides</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Multiple waveguides</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/mabuni1998/WaveguideQED.jl/blob/main/docs/src/multiplewaveguides.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Multiple-waveguides"><a class="docs-heading-anchor" href="#Multiple-waveguides">Multiple waveguides</a><a id="Multiple-waveguides-1"></a><a class="docs-heading-anchor-permalink" href="#Multiple-waveguides" title="Permalink"></a></h1><h2 id="twowaveguide"><a class="docs-heading-anchor" href="#twowaveguide">Two Waveguides</a><a id="twowaveguide-1"></a><a class="docs-heading-anchor-permalink" href="#twowaveguide" title="Permalink"></a></h2><p>In the previous examples, we have only considered cases with a single waveguide. In this tutorial, we show how to model a beamsplitter and an optical switch using two waveguides. A beamsplitter or a swap gate can be modelled using the Hamiltonian <span>$H_I = V(w_1^\dagger w_2 + w_2^\dagger w_1)$</span> where V is some interaction strength that determines which interaction is moddeled (we will discuss this in detail later). <span>$w_1$</span> and <span>$w_2$</span> is the annihilation operators of the two waveguides. A sketch of the system can be seen here:</p><p><img src="../illustrations/twowaveguide.png" alt="Alt text"/></p><p>We can describe the state of two waveguides with a total of N excitations by adding an argument specifying the number of waveguides as:</p><pre><code class="language-julia hljs">times = 0:0.1:10
dt = times[2] - times[1]
NPhotons = 2
NWaveguides = 2
bw = WaveguideBasis(NPhotons,NWaveguides,times)</code></pre><p>When creating operators, we now have to specify which waveguide they are acting on (in this case number one or two). This is done by an extra argument to <a href="../API/#QuantumOpticsBase.create"><code>create</code></a> and <a href="../API/#QuantumOpticsBase.destroy"><code>destroy</code></a>:</p><pre><code class="language-julia hljs">wd1 = create(bw,1)
w1 = destroy(bw,1)
wd2 = create(bw,2)
w2 = destroy(bw,2)</code></pre><p>Similarly, initializing one or two photon states in the first or second waveguide is done by:</p><pre><code class="language-julia hljs">ξ(t,σ,t0) = sqrt(2/σ)* (log(2)/pi)^(1/4)*exp(-2*log(2)*(t-t0)^2/σ^2)
ξ2(t1,t2,σ,t0) = ξ(t1,σ,t0)*ξ(t2,σ,t0)
ψ_single_1 = onephoton(bw,1,ξ,times,2,5)
ψ_double_1 = twophoton(bw,1,ξ2,times,2,5)
ψ_single_2 = onephoton(bw,2,ξ,times,2,5)
ψ_double_2 = twophoton(bw,2,ξ2,times,2,5)</code></pre><p>If we want to describe a simultanous excitation in both waveguides (states like <span>$\ket{1_i}_\mathrm{1}\ket{1_j }_\mathrm{2}$</span> where the subscript $\ket{1<em>i}</em>\mathrm{i}$ means waveguide i) we specify both indeces of the waveguides:</p><pre><code class="language-julia hljs">ψ_single_1_and_2 = twophoton(bw,[1,2],ξ2,times,2,5)</code></pre><h2 id="Beamsplitter"><a class="docs-heading-anchor" href="#Beamsplitter">Beamsplitter</a><a id="Beamsplitter-1"></a><a class="docs-heading-anchor-permalink" href="#Beamsplitter" title="Permalink"></a></h2><p>Let&#39;s now treat the same example as in <a href="../detection/#BStutorial">Interference on Beamsplitter</a>. We consider the two waveguides in a identic single photon state and thus use the above defined <code>ψ_single_1_and_2</code>. The Hamiltonian governing a beamsplitter in the time binned formalism has <span>$V= \pi/4$</span>:</p><pre><code class="language-julia hljs">V = pi/4
H = im*V/dt*(wd2*w1 - wd1*w2)</code></pre><p>We can then evolve the system under this Hamiltonian to perform the beamsplitting operation:</p><pre><code class="language-julia hljs">psi_out = waveguide_evolution(times,ψ_single_1_and_2,H)</code></pre><p>We can then view the final state to verify that we only have twophotons in the same waveguide simultanouesly:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; psi_second = TwoPhotonView(psi_out,2);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; psi_first = TwoPhotonView(psi_out,1);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; psi_first_second = TwoPhotonView(psi_out,[1,2]);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; norm(psi_second)^2</code><code class="nohighlight hljs ansi" style="display:block;">0.499999818220679</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; norm(psi_first)^2</code><code class="nohighlight hljs ansi" style="display:block;">0.499999818220679</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; norm(psi_first_second)^2</code><code class="nohighlight hljs ansi" style="display:block;">8.736388404016312e-7</code></pre><p>Except for numerical errors we thus have 50% chance of observing both photons in the same waveguide and 0 (8.736388404016349e-9)% of observing both photons in each of the waveguide simultanoues. </p><p>Similarly, we can plot the scattering / splitting of a single photon arriving in the left arm. </p><p><img src="../animations/bs.gif" alt="Alt text"/></p><h2 id="Swap"><a class="docs-heading-anchor" href="#Swap">Swap</a><a id="Swap-1"></a><a class="docs-heading-anchor-permalink" href="#Swap" title="Permalink"></a></h2><p>If we instead choose <span>$V = \pi / 2$</span> we get the SWAP operation. Let us consider one photon in the first waveguide and swap it to second waveguide and animate the evolution:</p><pre><code class="language-julia hljs">V = pi/2
H = im*V/dt*(wd2*w1 - wd1*w2)
psi_out_swap = waveguide_evolution(times,ψ_single_1,H)
first_after = OnePhotonView(psi_out_swap,1)
second_after = OnePhotonView(psi_out_swap,2)</code></pre><p><img src="../animations/swap.gif" alt="&quot;Alt text&quot;"/></p><div class="admonition is-info"><header class="admonition-header">WaveguideBasis(2,2,times) vs. Waveguide $\otimes$ Waveguide</header><div class="admonition-body"><p>Instead of using the custom basis for handling two waveguides, one could instead just do a tensor product between two waveguides basises. This naive approach would look something like:</p><pre><code class="nohighlight hljs">times = 0:0.1:10
bw = WaveguideBasis(2,times)
Btotal = bw ⊗ bw
nothing #hide</code></pre><p>This might work if you only consider single photon excitations in the waveguides, but if you go consider two photon excitations (as in the above) the hilbert space blows up. Indeed, in the above example, the hilbert space is of size: 27.594.009!!! However, since we often know that the system in total only has two excitations, there is no possibility of having two photons in both waveguides simultanously (states of type: <span>$\ket{1_k,1_j}_{1}\ket{1_l,1_m}_{2}$</span>). This part of the Hilber space takes up the majority since it scales as <span>$\propto N^4$</span> where N is the number of timebins. Instead we can exploit that only a total of two excitations is present simultanosly in the system. For this we use the custom basis <a href="../API/#WaveguideQED.WaveguideBasis"><code>WaveguideBasis</code></a> with an addination input stating the number of waveguides:</p><pre><code class="language- hljs">bw = WaveguideBasis(2,2,times)
nothing #hide</code></pre><p>The hilbert space is now of size: 20706, this is of course still large Hilbert space, but 3 orders of magnitude smaller than the naive approach as it still only scales as <span>$\propto N^2$</span>. </p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../detection/">« Detection and Projections</a><a class="docs-footer-nextpage" href="../example_lodahl/">Scattering on two level system »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Tuesday 11 April 2023 19:45">Tuesday 11 April 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
