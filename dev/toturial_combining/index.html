<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Combining with QuantumOptics.jl · CavityWaveguide.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">CavityWaveguide.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">CavityWaveguide.jl</a></li><li><span class="tocitem">Toturials</span><ul><li><a class="tocitem" href="../toturial_continous_fockstates/">Continous one Photon Fock States</a></li><li class="is-active"><a class="tocitem" href>Combining with QuantumOptics.jl</a><ul class="internal"><li><a class="tocitem" href="#Expectation-values"><span>Expectation values</span></a></li></ul></li><li><a class="tocitem" href="../toturial_2time_continous/">Continous Two Photon Fock States</a></li><li><a class="tocitem" href="../toturial_detection/">Beamsplitter interference</a></li></ul></li><li><span class="tocitem">How to...</span><ul><li><a class="tocitem" href="../detection_example/">Beamsplitter</a></li><li><a class="tocitem" href="../example_lodahl/">Input output waveguides</a></li></ul></li><li><a class="tocitem" href="../API/">API</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Toturials</a></li><li class="is-active"><a href>Combining with QuantumOptics.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Combining with QuantumOptics.jl</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/mabuni1998/CavityWaveguide/blob/main/docs/src/toturial_combining.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="combining"><a class="docs-heading-anchor" href="#combining">Combining with QuantumOptics.jl</a><a id="combining-1"></a><a class="docs-heading-anchor-permalink" href="#combining" title="Permalink"></a></h1><p>Basises, states, and operators defined in <code>CavityWaveguide.jl</code> can be effortlesly combined with operators from <a href="https://qojulia.org/"><code>QuantumOptics.jl</code></a>. As an example, we are going to consider a waveguide with a single photon pulse impinging on an empty onesided cavity. A sketch of the system can be seen here:</p><p><img src="../sketch_onesidedcavity.jpg" alt="alt text"/></p><p>We start by defining the basis of the cavity and waveguide:</p><pre><code class="language-julia hljs">using CavityWaveguide
using QuantumOptics
times = 0:0.1:10
bw = WaveguideBasis(1,times)
bc = FockBasis(1)</code></pre><p>Next we want to create the Hamiltonian for the system. The interaction between the waveguide and cavity is at timestep k given by<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup> <span>$H_k = i \hbar \sqrt{\gamma / \Delta t}( a^\dagger w_k - a w_k^\dagger)$</span>, where <span>$a$</span>     (<span>$a^\dagger$</span>) is the cavity annihilation (creation) operator, <span>$w_k$</span>(<span>$w_k^\dagger$</span>) is the waveguide annihilation (creation) operator, <span>$\gamma$</span> is the leakage rate of the cavity, and <code>\Delta t = times[2]-times[1]</code> is the width of the timebin. <code>CavityWaveguide.jl</code> follows the same syntax as <a href="https://qojulia.org/"><code>QuantumOptics.jl</code></a> and operators are defined from a basis. Operators of different Hilbert spaces are then combined using ⊗ (<span>$\otimes$</span>):</p><pre><code class="language-julia hljs">a = destroy(bc)
ad = create(bc)
w = destroy(bw)
wd = create(bw)
dt = times[2] - times[1]
γ = 1
H = im*sqrt(γ/dt)*( ad ⊗ w - a ⊗ wd  )</code></pre><p>With this we can now simulate the scattering of a single photon with a gaussian wavefunction scattered on a cavity. We define the initial state as waveguide state as:</p><pre><code class="language-julia hljs">ξ(t,σ,t0) = sqrt(2/σ)* (log(2)/pi)^(1/4)*exp(-2*log(2)*(t-t0)^2/σ^2)
σ,t0 = 1,5
ψ_waveguide = onephoton(bw,ξ,times,σ,t0)</code></pre><p>Assuming the cavity is empty the combined initial state is then:</p><pre><code class="language-julia hljs">ψ_in = fockstate(bc,0) ⊗ ψ_waveguide</code></pre><p>With the initial state we can then call the solver the get the wavefunction after the interaction with the cavity.</p><pre><code class="language-julia hljs">ψ_out = waveguide_evolution(times,ψ_in,H)</code></pre><p>Plotting the wavefunction and its norm square gives:</p><pre><code class="language-julia hljs">using PyPlot
viewed_state = OnePhotonView(ψ_out)
fig,ax = subplots(1,2,figsize=(9,4.5))
ax[1].plot(times,viewed_state,&quot;r-&quot;)
ax[1].set_xlabel(&quot;Time [a.u]&quot;)
ax[1].set_ylabel(L&quot;$\xi(t)$&quot;)

ax[2].plot(times,abs.(viewed_state).^2,&quot;r-&quot;)
ax[2].set_xlabel(&quot;Time [a.u]&quot;)
ax[2].set_ylabel(L&quot;$|\xi(t)|^2$&quot;)
plt.tight_layout()</code></pre><p><img src="../scat_onephoton.jpg" alt="alt text"/></p><p>We see that the wavefunction has changed after the interaction with the cavity. More specifically we see how the pulse gets absorped into the cavity leading and a corresponding phase change of the wave. This phase change also leads to destructive interference between the photon being emitted from the cavity and the reflection af the incoming photon. This leads to the dip in the photon wavefunction after the interaction.</p><h2 id="Expectation-values"><a class="docs-heading-anchor" href="#Expectation-values">Expectation values</a><a id="Expectation-values-1"></a><a class="docs-heading-anchor-permalink" href="#Expectation-values" title="Permalink"></a></h2><p>In the previous example, only the state at the final timestep was shown. This shows the output wavefunction, but one might also be interested in intermediate states or expectation values. Expectation values can be outputtet from the solver by using the <code>fout</code> keyword. As an example, we can get the number of photons in the cavity as a function of time by:</p><pre><code class="language-julia hljs">n = (ad*a) ⊗ identityoperator(bw)
function exp_na(time,psi)
    expect(n,psi)
end
ψ_out,na = waveguide_evolution(times,ψ_in,H,fout=exp_a)</code></pre><p>If we also want to know the number of photons in the waveguide state as a function of time, we can add <code>norm(OnePhotonView(psi))^2</code> to our expectation function as:</p><pre><code class="language-julia hljs">n = (ad*a) ⊗ identityoperator(bw)
function exp_na_and_nw(time,psi)
    (expect(n,psi),norm(OnePhotonView(psi))^2)
end
ψ_out,na,nw = waveguide_evolution(times,ψ_in,H,fout=exp_na_and_nw)</code></pre><p>Which we can plot as:</p><pre><code class="language-julia hljs">fig,ax = subplots(1,1,figsize=(9,4.5))
ax.plot(times,na,&quot;b-&quot;,label=&quot;na&quot;)
ax.plot(times,nw,&quot;r-&quot;,label=&quot;nw&quot;)
ax.plot(times,nw+na,&quot;g-&quot;,label=&quot;na+nw&quot;)
ax.set_xlabel(&quot;Time [a.u]&quot;)
ax.set_ylabel(&quot;Population&quot;)
plt.tight_layout()</code></pre><p><img src="../photon_number.jpg" alt="alt text"/></p><p>Here we see how the photon wavepacket is partially absorped into the cavity and then reemitted again.</p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a><a href="../references/#Heuck2020Photon-photonCavities">Mikkel Heuck, Kurt Jacobs, Dirk R. Englund (2020)</a></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../toturial_continous_fockstates/">« Continous one Photon Fock States</a><a class="docs-footer-nextpage" href="../toturial_2time_continous/">Continous Two Photon Fock States »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Monday 20 March 2023 15:44">Monday 20 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
