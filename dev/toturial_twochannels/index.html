<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Two Waveguides · WaveguideQED.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/style.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">WaveguideQED.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">WaveguideQED.jl</a></li><li><span class="tocitem">Theoretical Background</span><ul><li><a class="tocitem" href="../toturial_continous_fockstates/">Continous one Photon Fock States</a></li><li><a class="tocitem" href="../toturial_2time_continous/">Continous Two Photon Fock States</a></li></ul></li><li><span class="tocitem">Toturials</span><ul><li><a class="tocitem" href="../toturial_combining/">Combining with QuantumOptics.jl</a></li></ul></li><li><a class="tocitem" href="../toturial_detection/">Beamsplitter interference</a></li><li class="is-active"><a class="tocitem" href>Two Waveguides</a><ul class="internal"><li><a class="tocitem" href="#Beamsplitter"><span>Beamsplitter</span></a></li><li><a class="tocitem" href="#Swap"><span>Swap</span></a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../example_lodahl/">Input output waveguides</a></li></ul></li><li><a class="tocitem" href="../API/">API</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Two Waveguides</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Two Waveguides</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/mabuni1998/WaveguideQED.jl/blob/main/docs/src/toturial_twochannels.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="twowaveguide"><a class="docs-heading-anchor" href="#twowaveguide">Two Waveguides</a><a id="twowaveguide-1"></a><a class="docs-heading-anchor-permalink" href="#twowaveguide" title="Permalink"></a></h1><p>In the previous examples, we have only considered cases with a single waveguide. In this toturial, we show how to model a beamsplitter and an optical switch using two waveguides. A beamsplitter or a swap gate can be modelled using the Hamiltonian <span>$H = V(w_a^\dagger w_b + w_b^\dagger w_a)$</span> where V is some interaction strength that determines which interaction is moddeled (we will discuss this in detail later). <span>$w_a$</span> and <span>$w_b$</span> is the annihilation operators of the two waveguides. We can describe the state of two waveguides with a total of N excitations by adding an argument specifying the number of waveguides as:</p><pre><code class="language-julia hljs">times = 0:0.1:10
NPhotons = 2
NWaveguides = 2
bw_twophotons = WaveguideBasis(NPhotons,NWaveguides,times)</code></pre><p>When creating operators, we now have to specify which waveguide they are acting on (in this case number one or two). This is done by an extra argument to <a href="../API/#QuantumOpticsBase.create"><code>create</code></a> and <a href="../API/#QuantumOpticsBase.destroy"><code>destroy</code></a>:</p><pre><code class="language-julia hljs">wdL = create(bw,1)
wL = destroy(bw,1)
wdR = create(bw,2) 
wR = destroy(bw,2)</code></pre><p>Similarly, initializing one or two photon states in the first or second waveguide is done by:</p><pre><code class="language-julia hljs">ξ(t,σ,t0) = sqrt(2/σ)* (log(2)/pi)^(1/4)*exp(-2*log(2)*(t-t0)^2/σ^2)
ξ2(t1,t2,σ,t0) = ξ(t1,σ,t0)*ξ(t2,σ,t0)
ψ_single_first = onephoton(bw,1,ξ,times,2,5)
ψ_double_first = twophoton(bw,1,ξ2,times,2,5)
ψ_single_second = onephoton(bw,2,ξ,times,2,5)
ψ_double_second = twophoton(bw,2,ξ2,times,2,5)</code></pre><p>If we want to describe a simultanous excitation in both waveguides (states like <span>$\ket{1_i}_\mathrm{left}\ket{1_j }_\mathrm{right}$</span>) we specify both indeces of the waveguides:</p><pre><code class="language-julia hljs">ψ_single_first_and_second = twophoton(bw,[1,2],ξ2,times,2,5)</code></pre><h2 id="Beamsplitter"><a class="docs-heading-anchor" href="#Beamsplitter">Beamsplitter</a><a id="Beamsplitter-1"></a><a class="docs-heading-anchor-permalink" href="#Beamsplitter" title="Permalink"></a></h2><p>Let&#39;s now treat the same example as in <a href="../toturial_detection/#BStoturial">Interference on Beamsplitter</a>. We consider the two waveguides in a identic single photon state and thus use the above defined <code>ψ_single_first_and_second</code>. The Hamiltonian governing a beamsplitter in the time binned formalism has <span>$V= \pi/4$</span>:</p><pre><code class="language-julia hljs">V = pi/4
H = im*V/dt*(wdR*wL - wdL*wR)</code></pre><p>We can then evolve the system under this Hamiltonian to perform the beamsplitting operation:</p><pre><code class="language-julia hljs">psi_out = waveguide_evolution(times,ψ_single_first_and_second,H)</code></pre><p>We can then view the final state to verify that we only have twophotons in the same waveguide simultanouesly:</p><pre><code class="language-julia-repl hljs">psi_second = TwoPhotonView(psi_out,2)
psi_first = TwoPhotonView(psi_out,1)
psi_first_second = TwoPhotonView(psi_out,[1,2])
julia&gt; norm(psi_R)^2
julia&gt; norm(psi_L)^2
julia&gt; norm(psi_LR)^2
0.49999981822067935
0.49999981822067935
8.736388404016349e-7</code></pre><p>Except for numerical errors we thus have 50% chance of observing both photons in the same waveguide and 0 (8.736388404016349e-9)% of observing both photons in each of the waveguide simultanoues. </p><h2 id="Swap"><a class="docs-heading-anchor" href="#Swap">Swap</a><a id="Swap-1"></a><a class="docs-heading-anchor-permalink" href="#Swap" title="Permalink"></a></h2><p>If we instead choose <span>$V = \pi / 2$</span> we get the SWAP operation. Let us consider on photons in the left waveguide and swap them to right waveguide and plot before and after:</p><pre><code class="language-julia hljs">V = pi/2
H = im*V/dt*(wdR*wL - wdL*wR)
psi_out_swap = waveguide_evolution(times,ψ_single_first,H)
first_before = OnePhotonView(ψ_single_first,1)
second_before = OnePhotonView(ψ_single_first,2)
first_after = OnePhotonView(psi_out_swap,1)
second_after = OnePhotonView(psi_out_swap,2)

fig,ax = subplots(1,2,figsize=(9,4.5))
ax[1].plot(times,first_before,&quot;r-&quot;,label=&quot;First&quot;)
ax[1].plot(times,second_before,&quot;b-&quot;,label=&quot;Second&quot;)
ax[2].plot(times,first_after,&quot;r-&quot;)
ax[2].plot(times,second_after,&quot;b-&quot;)

ax[1].legend(loc=&quot;lower left&quot;)
ax[1].set_title(&quot;Before&quot;)
ax[1].set_xlabel(&quot;time [a.u]&quot;)
ax[1].set_ylabel(&quot;ξ(t)&quot;)

ax[2].set_title(&quot;After&quot;)
ax[2].set_xlabel(&quot;time [a.u]&quot;)

plt.tight_layout()</code></pre><p><img src="../swap.png" alt="&quot;Alt text&quot;"/></p><div class="admonition is-info"><header class="admonition-header">WaveguideBasis(2,2,times) vs. Waveguide $\otimes$ Waveguide</header><div class="admonition-body"><p>Instead of using the custom basis for handling two waveguides, one could instead just do a tensor product between two waveguides basises. This naive approach would look something like:</p><pre><code class="language-julia hljs">times = 0:0.1:10
bw = WaveguideBasis(2,times)
Btotal = bw ⊗ bw</code></pre><p>This might work if you only consider single photon excitations in the waveguides, but if you go consider two photon excitations (as in the above) the hilbert space blows up. Indeed, in the above example, the hilbert space is of size: 27.594.009!!! However, since we often know that the system in total only has two excitations, there is no possibility of having two photons in both waveguides simultanously (states of type: <span>$\ket{1_k,1_j}_{left}\ket{1_l,1_m}_{right}$</span>). This part of the Hilber space takes up the majority since it scales as <span>$\propto N^4$</span> where N is the number of timebins. Instead we can exploit that only a total of two excitations is present simultanosly in the system. For this we use the custom basis <a href="../API/#WaveguideQED.WaveguideBasis"><code>WaveguideBasis</code></a> with an addination input stating the number of waveguides:</p><pre><code class="language-julia hljs">bw = WaveguideBasis(2,2,times)</code></pre><p>The hilbert space is now of size: 20706, this is of course still large Hilbert space, but 3 orders of magnitude smaller than the naive approach as it still only scales as <span>$\propto N^2$</span>. </p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../toturial_detection/">« Beamsplitter interference</a><a class="docs-footer-nextpage" href="../example_lodahl/">Input output waveguides »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Monday 3 April 2023 19:52">Monday 3 April 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
