<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Non-Markovian dynamics · WaveguideQED.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/style.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">WaveguideQED.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">WaveguideQED.jl</a></li><li><a class="tocitem" href="../theoreticalbackground/">Theoretical Background</a></li><li><a class="tocitem" href="../tutorial/">Tutorials</a></li><li><a class="tocitem" href="../multiplewaveguides_v2/">Multiple Waveguides</a></li><li><a class="tocitem" href="../input_output/">Input-Output Relations</a></li><li class="is-active"><a class="tocitem" href>Non-Markovian dynamics</a><ul class="internal"><li><a class="tocitem" href="#feedback"><span>Waveguide and Mirror</span></a></li></ul></li><li><a class="tocitem" href="../API/">API</a></li><li><a class="tocitem" href="../references/">References and suggested readings</a></li><li><span class="tocitem">Experimental or Outdated functionalities</span><ul><li><a class="tocitem" href="../detection/">Detection and Projections</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Non-Markovian dynamics</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Non-Markovian dynamics</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/qojulia/WaveguideQED.jl/blob/main/docs/src/time_delay.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Non-Markovian-dynamics"><a class="docs-heading-anchor" href="#Non-Markovian-dynamics">Non-Markovian dynamics</a><a id="Non-Markovian-dynamics-1"></a><a class="docs-heading-anchor-permalink" href="#Non-Markovian-dynamics" title="Permalink"></a></h1><p>Non-Markovian dynamics or memory effects can arise in waveguide QED systems when the emitted light is reflected back into the system or when considering two spatially separated emitters. Waveguide systems with memory effects constitute a challenging class of problems because knowledge of the emitted field is inherently required to capture the correct feedback. In the <strong>WaveguideQED</strong> framework, we describe the entirety of the emitted field, which enables a straightforward treatment of memory effects, which we showcase below.</p><h2 id="feedback"><a class="docs-heading-anchor" href="#feedback">Waveguide and Mirror</a><a id="feedback-1"></a><a class="docs-heading-anchor-permalink" href="#feedback" title="Permalink"></a></h2><p>As an example of a system with memory effects, we consider a Semi-Infinite Waveguide terminating with a mirror in one end, as also depicted below. The mirror will here introduce a face shift <span>$\phi$</span>, but also an excitation emitted in the left mode will, after a delay time of <span>$\tau/2$</span>, be reflected into the right mode and thus, after a total delay time of <span>$\tau$</span> hit the emitter again.</p><p><img src="../illustrations/mirror_feedback.svg" alt="alt text"/></p><p>The left and right propagating modes are here symmetrical <a href="../references/#HughesWQEDMPP2021">Sofia Arranz Regidor, Gavin Crowder, Howard Carmichael, Stephen Hughes (2021)</a>, and one can instead think of a single mode wrapping around the emitter. The waveguide is thus a &quot;horseshoe&quot;, and the emitter couples to two points of the horseshoe. The two points are here seperated in time ensuring the feedback mechanism. This is also illustrated below.</p><p><img src="../illustrations/horseshoe.svg" alt="alt text"/></p><p>With this mental picture, there is only one propagating mode, and we describe the interaction through the Hamiltonian <a href="../references/#Whalen2019">S. J. Whalen (2019)</a>:</p><p class="math-container">\[\begin{equation}
H_k = \mathrm{e}^{i \phi} \sqrt{\gamma/2\Delta t} \left( \sigma^\dagger w_{k} + \sigma w_{k}^\dagger \right) + \sqrt{\gamma/2\Delta t} \left( \sigma^\dagger w_{k+\Tilde{\tau}} + \sigma w_{k+\Tilde{\tau}}^\dagger \right)
\end{equation}\]</p><p>where <span>$\Tilde{\tau} = \tau/\Delta t$</span> is the index necessary to introduce a time-delay of <span>$\tau$</span> between the emission and reabsorption. Note that it is the operator <span>$w_{k+\Tilde{\tau}}$</span> that never &quot;sees&quot; the emitted photon again (thus corresponding to the left propagating mode in the first figure, whereas the operator <span>$w_{k}$</span> experiences the emitted photon from <span>$\Tilde{\tau}$</span> time steps ago (and thus corresponds to the right propagating mode).  <span>$w_{k}^\dagger$</span> and <span>$w_{k}$</span> thus carry the phase factor <span>$\mathrm{e}^{i \phi}$</span> from the mirror.</p><p>This type of Hamiltonian is easily described in the <strong>WaveguideQED</strong> framework. We can here create &quot;delayed&quot; operators that address time bins at a delayed time, thus corresponding to <span>$w_{k+\Tilde{\tau}}$</span>. This can be done with the keyword <code>delay</code> when creating the operator that determines how many bins the delay should be. The value <code>delay</code> should therefore be an integer corresponding to <span>$\Tilde{\tau} = \tau/\Delta t$</span>. In the following, we define <span>$w_{k+\Tilde{\tau}}$</span> as <code>w_delayed</code>:</p><pre><code class="language-julia hljs">times = 0:0.1:11
dt = times[2]-times[1]
bw = WaveguideBasis(1,1,times)

delay_time = 1
w_delayed = destroy(bw;delay=delay_time/dt)
wd_delayed = create(bw;delay=delay_time/dt)</code></pre><p>The delayed operators are just normal WaveguideOperators addressing different time-bins and can, therefore, effortlessly be combined with the operators of the emitter:</p><pre><code class="language-julia hljs">be = FockBasis(1)
bw = WaveguideBasis(1,1,times)
sdw_delayed = create(be) ⊗ w_delayed
wds_delayed = destroy(be) ⊗ wd_delayed</code></pre><p>We can then create the non-delayed operators. We also define the Hamiltonian with a leakage rate of <span>$\gamma = 1$</span> and a mirror phase of <span>$\pi$</span>:</p><pre><code class="language-julia hljs">gamma = 1
phi = pi

sdw = create(be) ⊗ destroy(bw)
wds = destroy(be) ⊗ create(bw)

H_pi = exp(im*phi)*sqrt(gamma/2/dt)*(sdw+wds)+sqrt(gamma/2/dt)*(sdw_delayed+wds_delayed)</code></pre><p>Considering then how an initially excited emitter population decays, we create the expectation function <code>ne_exp</code> returning the emitter population and define the initial state. </p><pre><code class="language-julia hljs">sd = create(be) ⊗ identityoperator(bw)
s = destroy(be) ⊗ identityoperator(bw)
n = sd*s
function ne_exp(time,psi)
    expect(n,psi)
end

psi_initial = fockstate(be,1) ⊗ zerophoton(bw)</code></pre><p>Finally, we can solve the dynamics of the system and plot them.</p><pre><code class="language-julia hljs">_,ne_pi = waveguide_evolution(times, psi_initial, H_pi,fout=ne_exp)</code></pre><pre><code class="language-julia hljs">fig,ax = subplots(1,1,figsize=(9,4.5))
ax.plot(times,ne_pi,&quot;r-&quot;)
ax.set_xlabel(L&quot;time [$1/\gamma$]&quot;)
ax.set_ylabel(&quot;Population&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">/usr/lib/python3/dist-packages/matplotlib/cbook/__init__.py:1298: ComplexWarning: Casting complex values to real discards the imaginary part
  return np.asarray(x, float)</code></pre><p><img src="../feedback_pi.svg" alt="alt text"/></p><p>Here, we observe excitation trapping, where destructive interference from the mirror phase, prevents any excitation from going to the right after the initial feedback loop (notice the kink around <span>$t=1$</span>). This is a typical effect observed in these feedback systems, see <a href="../references/#HughesWQEDMPP2021">Sofia Arranz Regidor, Gavin Crowder, Howard Carmichael, Stephen Hughes (2021)</a>. Note that we observe an artifact in the simulation from <span>$t=10$</span> to <span>$t=11$</span> because the delayed operators are trying to address bins in the future which do not exist. To prevent such spurious results from appearing we can instead simulate for a shorter time such that the delay of the operators never exceed the time-bins over which the waveguide basis is defined. We illustrate this in the following by considering a mirror phase of <span>$\phi =0$</span> and only simulate until <span>$t=10$</span>:</p><pre><code class="language-julia hljs">phi = 0
H_zero = exp(im*phi)*sqrt(gamma/2/dt)*(sdw+wds)+sqrt(gamma/2/dt)*(sdw_delayed+wds_delayed)

times_sim = 0:0.1:10
_,ne_0 = waveguide_evolution(times_sim, psi_initial, H_zero,fout=ne_exp)</code></pre><p>This gives the plot:</p><pre><code class="language-julia hljs">fig,ax = subplots(1,1,figsize=(9,4.5))
ax.plot(times_sim,ne_pi[1:end-10],&quot;r-&quot;,label=L&quot;$\phi = \pi, \ \ \ \tau= 1$&quot;)
ax.plot(times_sim,ne_0,&quot;b-&quot;,label=L&quot;$\phi = 0, \ \ \ \tau= 1$&quot;)
ax.plot(times_sim,exp.(-times_sim),&quot;k--&quot;,label=L&quot;$\tau= \infty$&quot;)
ax.set_xlabel(L&quot;time [$1/\gamma$]&quot;)
ax.set_ylabel(&quot;Population&quot;)
ax.legend()</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">/usr/lib/python3/dist-packages/matplotlib/cbook/__init__.py:1298: ComplexWarning: Casting complex values to real discards the imaginary part
  return np.asarray(x, float)
/usr/lib/python3/dist-packages/matplotlib/cbook/__init__.py:1298: ComplexWarning: Casting complex values to real discards the imaginary part
  return np.asarray(x, float)</code></pre><p><img src="../feedback_0.svg" alt="alt text"/></p><p>For comparison, we here also plotted an exponential decay with the rate <span>$\gamma$</span> which corresponds to an infinite delay time. We see that for <span>$\phi=0$</span> we have constructive interference for the excitation going to the right and the population of the emitter decays faster than had there been no feedback. The photon thus experiences stimulated emission with itself!</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../input_output/">« Input-Output Relations</a><a class="docs-footer-nextpage" href="../API/">API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Saturday 1 July 2023 07:39">Saturday 1 July 2023</span>. Using Julia version 1.9.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
